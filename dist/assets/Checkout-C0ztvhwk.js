import{r as y,e as A,f as $,g as z,h as R,d as E,j as e,N as Q,L as f,n as o}from"./index-Dfil4IDX.js";import{u as _}from"./index.esm-CXSo-_yE.js";const T=()=>{const[d,j]=y.useState(null),[i,b]=y.useState(null),N=A(),{data:n}=$(),[v]=z(),[w]=R(),{data:r}=E(),{register:a,handleSubmit:k,reset:m}=_();function S(){const s="PO",t=Math.floor(Math.random()*1e4),c=String(t).padStart(4,"0"),I=new Date().getFullYear().toString().substr(-2),M=new Date().getMonth().toString(),O=new Date().getDate().toString();return`${s}${I}${M}${O}${c}`}const C=r==null?void 0:r.cart.reduce((s,t)=>s+t.product.price*t.quantity,0),F=r==null?void 0:r.cart.reduce((s,t)=>s+t.product.price*t.quantity-Math.floor(t.product.price-t.product.price*t.product.discountPercentage/100)*t.quantity,0),x=r==null?void 0:r.cart.reduce((s,t)=>s+Math.floor(t.product.price-t.product.price*t.product.discountPercentage/100)*t.quantity,0),u=x>500?0:50,g=x+u,h=r==null?void 0:r.cart.reduce((s,t)=>t.quantity+s,0),l=new Intl.NumberFormat("en-IN",{currency:"INR",style:"currency",minimumFractionDigits:0,maximumFractionDigits:0}),P=s=>{v(s),m()},q=s=>{j(n==null?void 0:n.addresses[s.target.value])},p=s=>{b(s.target.value)},D=async()=>{if(!d||!i){o.error("Please select an address and payment method");return}if(i==="online"){o.error("Razorpay Payment Method will be added soon");return}const s=S(),t={items:r==null?void 0:r.cart,total:g,totalItems:h,orderId:s,paymentMethod:i,user:d.user,shippingInfo:d.address,orderStatus:"processing"};w(t),sessionStorage.setItem("orderDetail",JSON.stringify(t)),o.success("Order Placed Successfully");const c=JSON.parse(sessionStorage==null?void 0:sessionStorage.orderDetail);N(`/success/${c.orderId}`,{replace:!0})};return e.jsxs(e.Fragment,{children:[(r==null?void 0:r.cart.length)===0&&e.jsx(Q,{to:"/",replace:!0}),e.jsx("div",{className:" mx-auto max-w-7xl px-0 sm:px-6 lg:px-8",children:e.jsxs("div",{className:"grid grid-cols-1 gap-x-8 gap-y-10 lg:grid-cols-5",children:[e.jsx("div",{className:"lg:col-span-3",children:e.jsx("form",{className:"bg-white py-2 px-5 mt-12",noValidate:!0,onSubmit:k(s=>P(s)),children:e.jsxs("div",{className:"space-y-12",children:[e.jsxs("div",{className:"border-b border-gray-900/10 pb-12",children:[e.jsx("h2",{className:"text-xl font-semibold leading-7 text-gray-900",children:"Delivery information"}),e.jsxs("div",{className:"mt-6 grid grid-cols-1 gap-x-6 gap-y-2 sm:grid-cols-6",children:[e.jsxs("div",{className:"sm:col-span-4",children:[e.jsx("label",{htmlFor:"name",className:"block text-sm font-medium leading-6 text-gray-900",children:"Full name"}),e.jsx("div",{className:"mt-2",children:e.jsx("input",{type:"text",...a("name",{required:!0}),id:"name",className:"block w-full rounded-md border-0 py-1.5 text-gray-900 shadow-sm ring-1 ring-inset ring-gray-300 placeholder:text-gray-400 focus:ring-2 focus:ring-inset focus:ring-green-600 sm:text-sm sm:leading-6"})})]}),e.jsxs("div",{className:"sm:col-span-4",children:[e.jsx("label",{htmlFor:"email",className:"block text-sm font-medium leading-6 text-gray-900",children:"Email address"}),e.jsx("div",{className:"mt-2",children:e.jsx("input",{id:"email",...a("email",{required:!0}),type:"email",className:"block w-full rounded-md border-0 py-1.5 text-gray-900 shadow-sm ring-1 ring-inset ring-gray-300 placeholder:text-gray-400 focus:ring-2 focus:ring-inset focus:ring-green-600 sm:text-sm sm:leading-6"})})]}),e.jsxs("div",{className:"sm:col-span-3",children:[e.jsx("label",{htmlFor:"phone",className:"block text-sm font-medium leading-6 text-gray-900",children:"Phone"}),e.jsx("div",{className:"mt-2",children:e.jsx("input",{id:"phone",...a("phone",{required:!0}),type:"number",className:"block w-full rounded-md border-0 py-1.5 text-gray-900 shadow-sm ring-1 ring-inset ring-gray-300 placeholder:text-gray-400 focus:ring-2 focus:ring-inset focus:ring-green-600 sm:text-sm sm:leading-6"})})]}),e.jsxs("div",{className:"col-span-full",children:[e.jsx("label",{htmlFor:"street",className:"block text-sm font-medium leading-6 text-gray-900",children:"Street address"}),e.jsx("div",{className:"mt-2",children:e.jsx("input",{type:"text",...a("street",{required:!0}),id:"street",className:"block w-full rounded-md border-0 py-1.5 text-gray-900 shadow-sm ring-1 ring-inset ring-gray-300 placeholder:text-gray-400 focus:ring-2 focus:ring-inset focus:ring-green-600 sm:text-sm sm:leading-6"})})]}),e.jsxs("div",{className:"sm:col-span-2 sm:col-start-1",children:[e.jsx("label",{htmlFor:"city",className:"block text-sm font-medium leading-6 text-gray-900",children:"City"}),e.jsx("div",{className:"mt-2",children:e.jsx("input",{type:"text",...a("city",{required:!0}),id:"city",className:"block w-full rounded-md border-0 py-1.5 text-gray-900 shadow-sm ring-1 ring-inset ring-gray-300 placeholder:text-gray-400 focus:ring-2 focus:ring-inset focus:ring-green-600 sm:text-sm sm:leading-6"})})]}),e.jsxs("div",{className:"sm:col-span-2",children:[e.jsx("label",{htmlFor:"state",className:"block text-sm font-medium leading-6 text-gray-900",children:"State"}),e.jsx("div",{className:"mt-2",children:e.jsx("input",{type:"text",...a("state",{required:!0}),id:"state",className:"block w-full rounded-md border-0 py-1.5 text-gray-900 shadow-sm ring-1 ring-inset ring-gray-300 placeholder:text-gray-400 focus:ring-2 focus:ring-inset focus:ring-green-600 sm:text-sm sm:leading-6"})})]}),e.jsxs("div",{className:"sm:col-span-2",children:[e.jsx("label",{htmlFor:"zip",className:"block text-sm font-medium leading-6 text-gray-900",children:"ZIP Code"}),e.jsx("div",{className:"mt-2",children:e.jsx("input",{type:"text",...a("zip",{required:!0}),id:"zip",className:"block w-full rounded-md border-0 py-1.5 text-gray-900 shadow-sm ring-1 ring-inset ring-gray-300 placeholder:text-gray-400 focus:ring-2 focus:ring-inset focus:ring-green-600 sm:text-sm sm:leading-6"})})]})]})]}),e.jsxs("div",{className:"mt-6 flex items-center justify-end gap-x-6",children:[e.jsx("button",{type:"button",onClick:()=>m(),className:"text-sm font-semibold leading-6 text-gray-900",children:"Reset"}),e.jsx("button",{type:"submit",className:"rounded-md bg-green-600 px-3 py-2 text-sm font-semibold text-white shadow-sm hover:bg-green-500 focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-green-600",children:"Add Address"})]}),e.jsxs("div",{className:"border-b border-gray-900/10 pb-12",children:[e.jsx("h2",{className:"text-base font-semibold leading-7 text-gray-900",children:"Addresses"}),e.jsx("p",{className:"mt-1 text-sm leading-6 text-gray-600",children:"Choose from existing Addresses"}),e.jsx("form",{className:"mt-5 grid gap-6",children:n==null?void 0:n.addresses.map((s,t)=>e.jsxs("div",{className:"relative",children:[e.jsx("input",{className:"peer hidden",id:`radio_${t}`,onChange:q,value:t,type:"radio",name:"radio",defaultChecked:""}),e.jsx("span",{className:"peer-checked:border-green-500 absolute right-4 top-1/2 box-content block h-3 w-3 -translate-y-1/2 rounded-full border-8 border-gray-300 bg-white"}),e.jsx("label",{className:"peer-checked:border-2 peer-checked:border-green-500 peer-checked:bg-gray-50 flex cursor-pointer select-none rounded-lg border border-gray-300 p-4",htmlFor:`radio_${t}`,children:e.jsxs("div",{className:"ml-5",children:[e.jsx("span",{className:"mt-2 font-semibold",children:s.address.name}),e.jsx("p",{className:"text-slate-500 text-sm leading-6",children:s.address.street}),e.jsx("p",{className:"text-slate-500 text-sm leading-6",children:s.address.city}),e.jsxs("p",{className:"text-slate-500 text-sm leading-6",children:[s.address.state," - ",s.address.zip]}),e.jsxs("p",{className:"text-slate-500 text-sm leading-6",children:["Phone number: ",s.address.phone]})]})})]},t))}),e.jsx("div",{className:"mt-10 space-y-10",children:e.jsxs("fieldset",{children:[e.jsx("legend",{className:"text-sm font-semibold leading-6 text-gray-900",children:"Payment Methods"}),e.jsx("p",{className:"mt-1 text-sm leading-6 text-gray-600",children:"Choose One"}),e.jsxs("div",{className:"mt-6 space-y-6",children:[e.jsxs("div",{className:"flex items-center gap-x-3",children:[e.jsx("input",{id:"online",name:"payments",onChange:p,value:"online",type:"radio",className:"h-4 w-4 border-gray-300 text-green-600 focus:ring-green-600"}),e.jsx("label",{htmlFor:"online",className:"block text-sm font-medium leading-6 text-gray-900",children:"Razorpay Secure (UPI, Cards, Wallets, NetBanking)"})]}),e.jsxs("div",{className:"flex items-center gap-x-3",children:[e.jsx("input",{id:"cash",name:"payments",value:"cod",onChange:p,type:"radio",className:"h-4 w-4 border-gray-300 text-green-600 focus:ring-green-600"}),e.jsx("label",{htmlFor:"cash",className:"block text-sm font-medium leading-6 text-gray-900",children:"Cash On Delivery (COD)"})]})]})]})})]})]})})}),e.jsx("div",{className:"lg:col-span-2 bg-[#e9e9e9]",children:e.jsxs("div",{className:"mx-auto sticky top-0  mt-12 max-w-7xl px-2 sm:px-5 lg:px-5",children:[e.jsx("h1",{className:"text-2xl font-bold tracking-tight text-gray-900",children:"Order Summary"}),e.jsx("div",{className:"px-0 py-6 sm:px-0",children:e.jsx("div",{className:"flow-root",children:e.jsx("ul",{className:"-my-6 divide-y divide-gray-200",children:r==null?void 0:r.cart.map((s,t)=>e.jsxs("li",{className:"flex py-6",children:[e.jsx("div",{className:"h-24 w-24 flex-shrink-0 overflow-hidden rounded-md border border-gray-200",children:e.jsx("img",{src:s.product.thumbnail.url,alt:s.product.name,className:"h-full w-full object-contain object-center"})}),e.jsxs("div",{className:"ml-4 flex flex-1 flex-col",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between text-base font-medium text-gray-900",children:[e.jsx("h3",{className:"line-clamp-1",children:e.jsx(f,{href:s.product._id,children:s.product.name})}),e.jsx("p",{className:"ml-4",children:l.format(Math.floor(s.product.price-s.product.price*s.product.discountPercentage/100)*s.quantity)})]}),e.jsxs("div",{className:"flex justify-between text-base font-medium text-gray-900",children:[e.jsx("p",{className:"mt-1 text-sm text-gray-500 line-clamp-1",children:s.product.category}),e.jsx("p",{className:"ml-4 text-gray-500 line-through",children:l.format(s.product.price*s.quantity)})]})]}),e.jsxs("div",{className:"flex flex-1 items-end justify-between text-sm",children:[e.jsx("p",{className:"text-gray-500",children:"Qty:"}),e.jsx("div",{className:"flex",children:e.jsx("p",{children:s.quantity})})]})]})]},t))})})}),e.jsxs("div",{className:"border-t border-gray-200 px-2 py-2 sm:px-2",children:[e.jsxs("div",{className:"flex justify-between my-2 text-base font-medium text-gray-500",children:[e.jsx("p",{children:"Subtotal"}),e.jsx("p",{children:l.format(C)})]}),e.jsxs("div",{className:"flex justify-between my-2 text-base font-medium text-gray-500",children:[e.jsx("p",{children:"Discount"}),e.jsxs("p",{children:[" – ",l.format(F)]})]}),e.jsxs("div",{className:"flex justify-between my-2 text-base font-medium text-gray-500",children:[e.jsx("p",{children:"Delivery Charge"}),e.jsx("p",{children:l.format(u)})]}),e.jsxs("div",{className:"flex justify-between my-2 text-base font-medium text-gray-900",children:[e.jsx("p",{children:"Total"}),e.jsx("p",{children:l.format(g)})]}),e.jsxs("div",{className:"flex justify-between my-2 text-base font-medium text-gray-900",children:[e.jsx("p",{children:"Total Items in Cart"}),e.jsxs("p",{children:[h," Items"]})]}),e.jsx("p",{className:"mt-0.5 text-sm text-gray-500",children:"Shopping upto ₹500 or more to get free delivery."}),e.jsx("div",{className:"mt-6 cursor-pointer",children:e.jsx("div",{onClick:D,className:"flex items-center justify-center rounded-md border border-transparent bg-green-600 px-6 py-3 text-base font-medium text-white shadow-sm hover:bg-green-700",children:"Proceed"})}),e.jsx("div",{className:"mt-6 flex justify-center text-center text-sm text-gray-500",children:e.jsxs("p",{children:["or"," ",e.jsx(f,{to:"/",children:e.jsxs("button",{type:"button",className:"font-medium text-green-600 hover:text-green-500",children:["Continue Shopping",e.jsx("span",{"aria-hidden":"true",children:" →"})]})})]})})]})]})})]})})]})};export{T as default};
